<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for wellness_plan/server/auth/local/passport.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../index.html">all files</a> / <a href="index.html">wellness_plan/server/auth/local/</a> passport.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">80.95% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>17/21</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">70% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>7/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">85.71% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>6/7</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">80% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>16/20</span>
      </div>
      <div class='fl pad1y'>
        <span class="strong">1 branch</span>
        <span class="quiet">Ignored</span>  &nbsp;&nbsp;&nbsp;&nbsp;
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.setup = setup;
// istanbul ignore next
&nbsp;
function _interopRequireDefault(obj) { return obj &amp;&amp; obj.__esModule ? <span class="branch-0 cbranch-skip" title="branch not covered" >obj </span>: { 'default': obj }; }
&nbsp;
var _passport = require('passport');
&nbsp;
var _passport2 = _interopRequireDefault(_passport);
&nbsp;
var _passportLocal = require('passport-local');
&nbsp;
function localAuthenticate(User, email, password, done) {
  User.findOneAsync({
    email: email.toLowerCase()
  }).then(function (user) {
    <span class="missing-if-branch" title="if path not taken" >I</span>if (!user) {
<span class="cstat-no" title="statement not covered" >      return done(null, false, {</span>
        message: 'This email is not registered.'
      });
    }
    user.authenticate(password, function (authError, authenticated) {
      <span class="missing-if-branch" title="if path not taken" >I</span>if (authError) {
<span class="cstat-no" title="statement not covered" >        return done(authError);</span>
      }
      <span class="missing-if-branch" title="if path not taken" >I</span>if (!authenticated) {
<span class="cstat-no" title="statement not covered" >        return done(null, false, { message: 'This password is not correct.' });</span>
      } else {
        return done(null, user);
      }
    });
  })['catch'](<span class="fstat-no" title="function not covered" >function (err) {</span>
<span class="cstat-no" title="statement not covered" >    return done(err);</span>
  });
}
&nbsp;
function setup(User, config) {
  _passport2['default'].use(new _passportLocal.Strategy({
    usernameField: 'email',
    passwordField: 'password' // this is the virtual field on the model
  }, function (email, password, done) {
    return localAuthenticate(User, email, password, done);
  }));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYWNoaW5lMi9wcm9qZWN0cy93ZWxsbmVzc19wbGFuL3NlcnZlci9hdXRoL2xvY2FsL3Bhc3Nwb3J0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7d0JBQXFCLFVBQVU7Ozs7NkJBQ1MsZ0JBQWdCOztBQUV4RCxTQUFTLGlCQUFpQixDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtBQUN0RCxNQUFJLENBQUMsWUFBWSxDQUFDO0FBQ2hCLFNBQUssRUFBRSxLQUFLLENBQUMsV0FBVyxFQUFFO0dBQzNCLENBQUMsQ0FDQyxJQUFJLENBQUMsVUFBQSxJQUFJLEVBQUk7QUFDWixRQUFJLENBQUMsSUFBSSxFQUFFO0FBQ1QsYUFBTyxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRTtBQUN2QixlQUFPLEVBQUUsK0JBQStCO09BQ3pDLENBQUMsQ0FBQztLQUNKO0FBQ0QsUUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsVUFBUyxTQUFTLEVBQUUsYUFBYSxFQUFFO0FBQzdELFVBQUksU0FBUyxFQUFFO0FBQ2IsZUFBTyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7T0FDeEI7QUFDRCxVQUFJLENBQUMsYUFBYSxFQUFFO0FBQ2xCLGVBQU8sSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsRUFBRSxPQUFPLEVBQUUsK0JBQStCLEVBQUUsQ0FBQyxDQUFDO09BQ3hFLE1BQU07QUFDTCxlQUFPLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7T0FDekI7S0FDRixDQUFDLENBQUM7R0FDSixDQUFDLFNBQ0ksQ0FBQyxVQUFBLEdBQUc7V0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDO0dBQUEsQ0FBQyxDQUFDO0NBQzVCOztBQUVNLFNBQVMsS0FBSyxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUU7QUFDbEMsd0JBQVMsR0FBRyxDQUFDLDRCQUFrQjtBQUM3QixpQkFBYSxFQUFFLE9BQU87QUFDdEIsaUJBQWEsRUFBRSxVQUFVO0dBQzFCLEVBQUUsVUFBUyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtBQUNqQyxXQUFPLGlCQUFpQixDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0dBQ3ZELENBQUMsQ0FBQyxDQUFDO0NBQ0wiLCJmaWxlIjoiL1VzZXJzL21hY2hpbmUyL3Byb2plY3RzL3dlbGxuZXNzX3BsYW4vc2VydmVyL2F1dGgvbG9jYWwvcGFzc3BvcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGFzc3BvcnQgZnJvbSAncGFzc3BvcnQnO1xuaW1wb3J0IHtTdHJhdGVneSBhcyBMb2NhbFN0cmF0ZWd5fSBmcm9tICdwYXNzcG9ydC1sb2NhbCc7XG5cbmZ1bmN0aW9uIGxvY2FsQXV0aGVudGljYXRlKFVzZXIsIGVtYWlsLCBwYXNzd29yZCwgZG9uZSkge1xuICBVc2VyLmZpbmRPbmVBc3luYyh7XG4gICAgZW1haWw6IGVtYWlsLnRvTG93ZXJDYXNlKClcbiAgfSlcbiAgICAudGhlbih1c2VyID0+IHtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gZG9uZShudWxsLCBmYWxzZSwge1xuICAgICAgICAgIG1lc3NhZ2U6ICdUaGlzIGVtYWlsIGlzIG5vdCByZWdpc3RlcmVkLidcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB1c2VyLmF1dGhlbnRpY2F0ZShwYXNzd29yZCwgZnVuY3Rpb24oYXV0aEVycm9yLCBhdXRoZW50aWNhdGVkKSB7XG4gICAgICAgIGlmIChhdXRoRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4gZG9uZShhdXRoRXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYXV0aGVudGljYXRlZCkge1xuICAgICAgICAgIHJldHVybiBkb25lKG51bGwsIGZhbHNlLCB7IG1lc3NhZ2U6ICdUaGlzIHBhc3N3b3JkIGlzIG5vdCBjb3JyZWN0LicgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwgdXNlcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiBkb25lKGVycikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXAoVXNlciwgY29uZmlnKSB7XG4gIHBhc3Nwb3J0LnVzZShuZXcgTG9jYWxTdHJhdGVneSh7XG4gICAgdXNlcm5hbWVGaWVsZDogJ2VtYWlsJyxcbiAgICBwYXNzd29yZEZpZWxkOiAncGFzc3dvcmQnIC8vIHRoaXMgaXMgdGhlIHZpcnR1YWwgZmllbGQgb24gdGhlIG1vZGVsXG4gIH0sIGZ1bmN0aW9uKGVtYWlsLCBwYXNzd29yZCwgZG9uZSkge1xuICAgIHJldHVybiBsb2NhbEF1dGhlbnRpY2F0ZShVc2VyLCBlbWFpbCwgcGFzc3dvcmQsIGRvbmUpO1xuICB9KSk7XG59XG4iXX0=</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Fri Dec 18 2015 13:10:30 GMT-0500 (EST)
</div>
</div>
<script src="../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../sorter.js"></script>
</body>
</html>
