<navbar></navbar>
<div class="content-wrapper" >
  <div class="container content">
    <div class="row page-title">
      <div class="col-sm-12" style="padding: 0 50px;">
        <div class="page-header">
          <button ng-show="vm.plan.patient" class="btn btn-info pull-right" ng-click="vm.viewAllPlans()">View All</button>
          <h1>{{vm.pageTitle}}</h1>
          <span class="subheader" ng-show="vm.plan.patient">{{vm.plan.patient.name.first}} {{vm.plan.patient.name.last}}'s Wellness Plan</span>
        </div>
      </div>
    </div><!-- .page-title -->

    <div class="row patient-info" ng-show="vm.plan.patient">
      <div class="col-md-4 ">
        <h3>Patient Info</h3>
        <span class="patient-info">Name: {{vm.plan.patient.name.first}}  {{vm.plan.patient.name.last}}</span> <br>
        <span class="patient-info">Date Of Birth: {{vm.plan.patient.dob}}</span>
        <hr>
      </div>
      <div class="col-md-4 col-md-offset-4">
        <button class="btn btn-success" ng-show="!vm.viewing" ng-click="vm.viewing=true">View Plan</button>
        <button class="btn btn-warning" ng-show="vm.viewing" ng-click="vm.viewing=false">Edit Plan</button>
        <button class="btn btn-warning" ng-show="vm.viewing" ng-click="vm.exportPlan(plan)">Export Plan</button>
      </div>
    </div>  <!-- End Patient Info -->


    <div id="plans-table" class="row" ng-hide="vm.plan.patient">
      <div class="col-sm-12" ng-show="vm.plans.length > 0">
        <table class="table table-bordered table-striped table-condensed table-hover table-responsive">
            <thead>
              <th>Patient Name</th>
              <th>Date Of Birth</th>
              <th>Created</th>
              <th></th>
            </thead>
            <tbody>
              <tr ng-repeat="plan in vm.plans">
                <td><a ui-sref="plan({id: plan._id})">{{plan.patient.name.last}}, {{plan.patient.name.first}}</a></td>
                <td>{{plan.patient.dob}}</td>
                <td>{{plan.createdAt | date}}</td>
                <td style="text-align: center;"><i class="fa fa-trash trash" ng-click="vm.deletePlan(plan.patientName, plan)"></i></td>
              </tr>
            </tbody>
          </table>
      </div>
      <div class="col-sm-12" ng-hide="vm.plans.length > 0">
        <h5 style="text-align: center;">You have not created any plans.</h5>
        <h5 style="text-align: center;">Enter a patient's details below to create your first plan!</h5>
      </div>
    </div> <!-- End Plans Table -->

    <div id="new-plan-form" class="row">
      <div class="col-sm-12 col-md-6">
        <div class="row">
          <form class="plan-form" name="planForm" ng-submit="vm.addPlan(planForm)" novalidate>
            <div class="form-group col-sm-4" ng-class="planForm.firstname.$error.required && vm.submitted ? 'has-error' : ''">
              <input type="text" class="form-control" name="firstname" placeholder="First Name" ng-model="vm.newPlanModel.patient.name.first"  required>
            </div>
            <div class="form-group col-sm-4" ng-class="planForm.lastname.$error.required && vm.submitted ? 'has-error' : ''">
              <input type="text" class="form-control" name="lastname" placeholder="Last Name" ng-model="vm.newPlanModel.patient.name.last"  required>
            </div>
            <div class="form-group col-sm-4" ng-class="planForm.dob.$error.required && vm.submitted ? 'has-error' : ''" required>
              <input type="text" class="form-control" name="dob" placeholder="DOB" ng-model="vm.newPlanModel.patient.dob" required>
            </div>
            <div class="form-group col-sm-12">
              <textarea class="form-control" placeholder="Notes" ng-model="vm.newPlanModel.notes"></textarea>
            </div>

            <div class="form-group has-error">
              <div class="col-sm-12">
                <p class="help-block" ng-show="planForm.firstname.$error.required && vm.submitted">
                   Please enter a first name
                </p>
                <p class="help-block" ng-show="planForm.lastname.$error.required && vm.submitted">
                   Please enter a last name
                </p>
                <p class="help-block" ng-show="planForm.dob.$error.required && vm.submitted">
                   Please enter a date of birth
                </p>

                <p class="help-block">{{ vm.errors.other }}</p>
              </div>
            </div>
            <div class="col-sm-12">
              <button type="submit" class="btn btn-primary">Add New</button>
            </div>
          </form>
        </div>
      </div>
    </div> <!-- End New Plan Form -->

    <div class="row footer-wrapper">
      <footer></footer>
    </div>
  </div>
</div>
