<navbar></navbar>
<div class="content-wrapper" >
  <div class="container content">
    <div class="row">
      <div class="col-sm-12" style="padding: 0 50px;">
        <div class="page-header">
          <button ng-show="plan.patient" class="btn btn-info pull-right" ng-click="dashboard.viewAllPlans()">View All</button>
          <h1>{{pageTitle}}</h1>
          <span class="subheader" ng-show="plan.patient">{{plan.patient.name.first}} {{plan.patient.name.last}}'s Wellness Plan</span>
        </div>      
      </div>
    </div>
    <div class="row" ng-show="plan.patient">
      <div class="col-md-4">
        <h3>Patient Info</h3>
        <div class="form-group">
          <label for="firstname">First Name</label>
          <input type="text" class="form-control" name="firstname" placeholder="First Name" ng-model="plan.patient.name.first" required>
        </div>
        <div class="form-group" ng-class="planForm.lastname.$error.required && dashboard.submitted ? 'has-error' : ''">
          <label for="lastname">Last Name</label>
          <input type="text" class="form-control" name="lastname" placeholder="Last Name" ng-model="plan.patient.name.last" required>
        </div>
        <div class="form-group" ng-class="planForm.dob.$error.required && dashboard.submitted ? 'has-error' : ''">
          <label for="dob">Date of Birth</label>
          <input type="text" class="form-control" name="dob" placeholder="DOB" ng-model="plan.patient.dob" required>
        </div>
      </div>
    </div>
    <div class="row" ng-hide="plan.patient">
      <div class="col-sm-12" ng-show="dashboard.myPlans.length > 0">
        <table class="table table-bordered table-striped table-condensed table-hover table-responsive">
            <thead>
              <th>Patient Name</th>
              <th>Date Of Birth</th>
              <th>Created</th>
              <th colspan="3">Options</th>
            </thead>
            <tbody>
              <tr ng-repeat="plan in dashboard.myPlans">
                <td><a href="#" ng-click="dashboard.view(plan)">{{plan.patient.name.last}}, {{plan.patient.name.first}}</a></td>
                <td>{{plan.patient.dob}}</td>
                <td><span am-time-ago="plan.created_at"></span></td>
                <td style="text-align: center;"><i class="fa fa-pencil edit" ng-click="dashboard.editPlan(plan)"></i></td>
                <td style="text-align: center;"><i class="fa fa-file-pdf-o edit" ng-click="dashboard.exportPlan(plan)"></i></td>
                <td style="text-align: center;"><i class="fa fa-trash trash" ng-click="dashboard.deletePlan(plan)"></i></td>
              </tr>
            </tbody>
          </table>
      </div>
      <div class="col-sm-12" ng-hide="dashboard.myPlans.length > 0">
        <h5 style="text-align: center;">You have not created any plans.</h5>
        <h5 style="text-align: center;">Enter a patient's details below to create your first plan!</h5>
      </div>
    </div>
    <div class="row" ng-hide="plan.patient">
      <div class="col-sm-12 col-md-6">
        <div class="row">
          <form class="plan-form" name="planForm" ng-submit="dashboard.addPlan(planForm)" novalidate>
            <div class="form-group col-sm-4" ng-class="planForm.firstname.$error.required && dashboard.submitted ? 'has-error' : ''">
              <input type="text" class="form-control" name="firstname" placeholder="First Name" ng-model="dashboard.newPlan.firstname" required>
            </div>
            <div class="form-group col-sm-4" ng-class="planForm.lastname.$error.required && dashboard.submitted ? 'has-error' : ''">
              <input type="text" class="form-control" name="lastname" placeholder="Last Name" ng-model="dashboard.newPlan.lastname" required>
            </div>
            <div class="form-group col-sm-4" ng-class="planForm.dob.$error.required && dashboard.submitted ? 'has-error' : ''">
              <input type="text" class="form-control" name="dob" placeholder="DOB" ng-model="dashboard.newPlan.dob" required>
            </div>
            <div class="form-group col-sm-12">
              <textarea class="form-control" placeholder="Notes" ng-model="dashboard.newPlan.notes"></textarea>
            </div>

            <div class="form-group has-error">
              <div class="col-sm-12">
                <p class="help-block" ng-show="planForm.firstname.$error.required && dashboard.submitted">
                   Please enter a first name
                </p>
                <p class="help-block" ng-show="planForm.lastname.$error.required && dashboard.submitted">
                   Please enter a last name
                </p>
                <p class="help-block" ng-show="planForm.dob.$error.required && dashboard.submitted">
                   Please enter a date of birth
                </p>

                <p class="help-block">{{ dashboard.errors.other }}</p>
              </div>
            </div>
            <div class="col-sm-12">
              <button type="submit" class="btn btn-primary">Add New</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div class="row">
      <footer></footer>
    </div>
  </div>
</div>